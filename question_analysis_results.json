{
  "analysis_results": [
    {
      "id": 1,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את כל הבסיסים הממוקמים בצפון מטבלת AirBases.",
      "solution": "SELECT * FROM AirBases WHERE location = 'צפון';"
    },
    {
      "id": 2,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות הטייסות שמספר הטייסים הפעילים שלהן נמוך מ-20 מטבלת Squadrons.",
      "solution": "SELECT squadron_name FROM Squadrons WHERE active_pilots < 20;"
    },
    {
      "id": 3,
      "current_difficulty": "easy",
      "new_difficulty": "medium",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות הטייסים שמשרתים בבסיס 'RMD' ומשכורתם מעל 17000 ש״ח.",
      "solution": "SELECT pilot_name FROM Pilots p JOIN AirBases a ON p.base_id = a.base_id WHERE a.base_code = 'RMD' AND p.salary > 17000;"
    },
    {
      "id": 4,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית לבחירת כלי טיס מהטבלה Aircraft שהם מסוג 'F-16'.",
      "solution": "σ_aircraft_type='F-16'(Aircraft)"
    },
    {
      "id": 5,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות הבסיסים מטבלת AirBases שיש בהם יותר מ-1000 איש צוות.",
      "solution": "SELECT base_name FROM AirBases WHERE personnel_capacity > 1000;"
    },
    {
      "id": 6,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": false,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית להטלת עמודות weapon_name ו-cost_per_unit מטבלת Weapons.",
      "solution": "π_weapon_name,cost_per_unit(Weapons)"
    },
    {
      "id": 7,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את הטייסות שהוקמו לפני שנת 1980 ומתמחות במשימות 'קרב' מטבלת Squadrons.",
      "solution": "SELECT squadron_name FROM Squadrons WHERE established_year < 1980 AND mission_type = 'קרב';"
    },
    {
      "id": 8,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות כלי הנשק היקרים ביותר (עלות מעל 1000 אלפי ש״ח) ואת הטווח שלהם.",
      "solution": "SELECT weapon_name, range_km FROM Weapons WHERE cost_per_unit > 1000;"
    },
    {
      "id": 9,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את המשכורת הממוצעת של טייסים לכל טייסת מטבלת Pilots.",
      "solution": "SELECT squadron_id, AVG(salary) as avg_salary FROM Pilots GROUP BY squadron_id;"
    },
    {
      "id": 10,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמציגה את כמות כלי הטיס בכל טייסת מטבלת Aircraft, ממוינת לפי מספר הטייסת.",
      "solution": "SELECT s.squadron_number, COUNT(*) as aircraft_count FROM Aircraft a JOIN Squadrons s ON a.squadron_id = s.squadron_id GROUP BY s.squadron_number ORDER BY s.squadron_number;"
    },
    {
      "id": 11,
      "current_difficulty": "medium",
      "new_difficulty": "medium",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות הטייסים ושמות הטייסות שלהם. השתמש ב-JOIN בין Pilots ו-Squadrons.",
      "solution": "SELECT p.pilot_name, s.squadron_name FROM Pilots p JOIN Squadrons s ON p.squadron_id = s.squadron_id;"
    },
    {
      "id": 12,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את כלי הטיס המהירים ביותר (מהירות מעל 2000 קמ״ש) שהטווח שלהם פחות מ-3000 ק״מ מטב...",
      "solution": "SELECT aircraft_type, tail_number FROM Aircraft WHERE max_speed > 2000 AND range_km < 3000;"
    },
    {
      "id": 13,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות הבסיסים ואת מספר הטייסים הממוצע בהם, רק עבור בסיסים ברמת ביטחון גבוהה מ-...",
      "solution": "SELECT b.base_name, AVG(s.active_pilots) FROM AirBases b JOIN Squadrons s ON b.base_id = s.base_id WHERE b.security_level > 8 GROUP BY b.base_name;"
    },
    {
      "id": 14,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את העלות הממוצעת לשעת טיסה (אלפי ש״ח/שעה) של כל סוג כלי טיס מטבלת Aircraft.",
      "solution": "SELECT aircraft_type, AVG(cost_per_hour) as avg_cost_per_hour FROM Aircraft GROUP BY aircraft_type;"
    },
    {
      "id": 15,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": true,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית לאיחוד (Union) של טייסים מרמת דוד וטייסים מחצרים.",
      "solution": "σ_base_id=1(Pilots) ∪ σ_base_id=2(Pilots)"
    },
    {
      "id": 16,
      "current_difficulty": "medium",
      "new_difficulty": "medium",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את כלי הטיס ואת שמות הטייסות שלהן, כולל כלי טיס שאין להם טייסת (LEFT JOIN).",
      "solution": "SELECT a.tail_number, s.squadron_name FROM Aircraft a LEFT JOIN Squadrons s ON a.squadron_id = s.squadron_id;"
    },
    {
      "id": 17,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את שנת הייסוד הממוצעת של הטייסות בכל סוג משימה מטבלת Squadrons.",
      "solution": "SELECT mission_type, AVG(established_year) as avg_established_year FROM Squadrons GROUP BY mission_type;"
    },
    {
      "id": 18,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמציגה את יחס 'עומס הטייסים' של כל טייסת - מספר הטייסים הפעילים חלקי כמות כלי הטיס מטבלת...",
      "solution": "SELECT squadron_name, (active_pilots / aircraft_count) as pilot_to_aircraft_ratio FROM Squadrons;"
    },
    {
      "id": 19,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 2,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 3,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות הטייסים, שמות הבסיסים ושמות הטייסות שלהם באמצעות JOIN משולש.",
      "solution": "SELECT p.pilot_name, b.base_name, s.squadron_name FROM Pilots p JOIN AirBases b ON p.base_id = b.base_id JOIN Squadrons s ON p.squadron_id = s.squadron_id;"
    },
    {
      "id": 20,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית שמחבר את הטבלאות Squadrons ו-Aircraft על בסיס squadron_id ומחזיר רק טייסות ע...",
      "solution": "σ_aircraft_type='F-35'(Squadrons ⋈_Squadrons.squadron_id=Aircraft.squadron_id Aircraft)"
    },
    {
      "id": 21,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": true,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את כמות הטייסים בכל בסיס, רק עבור בסיסים שיש בהם יותר מ-20 טייסים.",
      "solution": "SELECT base_id, COUNT(*) as pilot_count FROM Pilots GROUP BY base_id HAVING COUNT(*) > 20;"
    },
    {
      "id": 22,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 1,
        "has_subquery": true,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את הטייסים ששעות הטיסה שלהם גבוהות משעות הטיסה הממוצעות של כל הטייסים.",
      "solution": "SELECT pilot_name, flight_hours FROM Pilots WHERE flight_hours > (SELECT AVG(flight_hours) FROM Pilots);"
    },
    {
      "id": 23,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית להצגת הפרש (Difference) בין כל כלי הנשק לבין כלי הנשק מסוג 'אוויר-אוויר'.",
      "solution": "Weapons − σ_weapon_type='אוויר-אוויר'(Weapons)"
    },
    {
      "id": 24,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 2,
        "has_subquery": true,
        "has_multiple_subqueries": true,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": true,
        "has_union": false,
        "has_intersect": false,
        "has_exists": true,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 3,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות הבסיסים שיש בהן גם טייסים וגם כלי נשק (באמצעות INTERSECT או EXISTS).",
      "solution": "SELECT DISTINCT b.base_name FROM AirBases b WHERE EXISTS (SELECT 1 FROM Pilots p WHERE p.base_id = b.base_id) AND EXISTS (SELECT 1 FROM Weapons w WHERE w.storage_base_id = b.base_id);"
    },
    {
      "id": 25,
      "current_difficulty": "hard",
      "new_difficulty": "medium",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את פירוט עלות התפעול החודשית עבור כל טייס (שם, משכורת, עלות טיסה חודשית), בהנחה ...",
      "solution": "SELECT p.pilot_name, p.salary, (a.cost_per_hour * 20) as monthly_flight_cost FROM Pilots p JOIN Aircraft a ON p.squadron_id = a.squadron_id;"
    },
    {
      "id": 26,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את כל כלי הטיס במצב 'פעיל' מטבלת Aircraft.",
      "solution": "SELECT * FROM Aircraft WHERE status = 'פעיל';"
    },
    {
      "id": 27,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות הבסיסים שהוקמו לפני שנת 1950 מטבלת AirBases.",
      "solution": "SELECT base_name FROM AirBases WHERE established_year < 1950;"
    },
    {
      "id": 28,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את כלי הנשק שהמלאי שלהם נמוך מהמינימום הנדרש מטבלת Weapons.",
      "solution": "SELECT weapon_name FROM Weapons WHERE stock_quantity < minimum_stock;"
    },
    {
      "id": 29,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית לבחירת טייסים מהטבלה Pilots עם דרגה 'רס\"ן'.",
      "solution": "σ_rank='רס\"ן'(Pilots)"
    },
    {
      "id": 30,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את המשימות בסטטוס 'הושלמה' מטבלת Missions.",
      "solution": "SELECT * FROM Missions WHERE mission_status = 'הושלמה';"
    },
    {
      "id": 31,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": false,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית להטלת עמודות base_name ו-location מטבלת AirBases.",
      "solution": "π_base_name,location(AirBases)"
    },
    {
      "id": 32,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את הטייסים בגילאי 25-35 מטבלת Pilots.",
      "solution": "SELECT pilot_name FROM Pilots WHERE age BETWEEN 25 AND 35;"
    },
    {
      "id": 33,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את כלי הטיס שיוצרו אחרי שנת 2010 מטבלת Aircraft.",
      "solution": "SELECT aircraft_type, tail_number FROM Aircraft WHERE manufacture_year > 2010;"
    },
    {
      "id": 34,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את הטייסות שמספר כלי הטיס שלהן גדול מ-15 מטבלת Squadrons.",
      "solution": "SELECT squadron_name FROM Squadrons WHERE aircraft_count > 15;"
    },
    {
      "id": 35,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות כלי הנשק מסוג 'אוויר-קרקע' מטבלת Weapons.",
      "solution": "SELECT weapon_name FROM Weapons WHERE weapon_type = 'אוויר-קרקע';"
    },
    {
      "id": 36,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את הבסיסים עם יותר מ-2 מסלולי נחיתה מטבלת AirBases.",
      "solution": "SELECT base_name FROM AirBases WHERE runways_count > 2;"
    },
    {
      "id": 37,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את הטייסים עם התמחות 'קרב אוויר' מטבלת Pilots.",
      "solution": "SELECT pilot_name FROM Pilots WHERE specialty = 'קרב אוויר';"
    },
    {
      "id": 38,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית לבחירת משימות מהטבלה Missions עם רמת עדיפות 5.",
      "solution": "σ_priority_level=5(Missions)"
    },
    {
      "id": 39,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את כלי הטיס שעברו יותר מ-5000 שעות טיסה מטבלת Aircraft.",
      "solution": "SELECT tail_number, flight_hours_total FROM Aircraft WHERE flight_hours_total > 5000;"
    },
    {
      "id": 40,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את הטייסות המתמחות ב'תובלה' או ב'חילוץ' מטבלת Squadrons.",
      "solution": "SELECT squadron_name FROM Squadrons WHERE mission_type = 'תובלה' OR mission_type = 'חילוץ';"
    },
    {
      "id": 41,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": false,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית להטלת עמודות pilot_name ו-rank מטבלת Pilots.",
      "solution": "π_pilot_name,rank(Pilots)"
    },
    {
      "id": 42,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את כלי הנשק עם טווח פחות מ-50 ק\"מ מטבלת Weapons.",
      "solution": "SELECT weapon_name, range_km FROM Weapons WHERE range_km < 50;"
    },
    {
      "id": 43,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את הבסיסים ברמת ביטחון מעל 8 מטבלת AirBases.",
      "solution": "SELECT base_name, security_level FROM AirBases WHERE security_level > 8;"
    },
    {
      "id": 44,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את המשימות שארכו יותר מ-3 שעות מטבלת Missions.",
      "solution": "SELECT mission_name, flight_duration_hours FROM Missions WHERE flight_duration_hours > 3;"
    },
    {
      "id": 45,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את הטייסים עם יותר מ-10 שנות ניסיון מטבלת Pilots.",
      "solution": "SELECT pilot_name, experience_years FROM Pilots WHERE experience_years > 10;"
    },
    {
      "id": 46,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את כמות הטייסים הכוללת בכל בסיס מטבלת Pilots.",
      "solution": "SELECT base_id, COUNT(*) as total_pilots FROM Pilots GROUP BY base_id;"
    },
    {
      "id": 47,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את העלות הכוללת של כל סוג כלי נשק במלאי מטבלת Weapons.",
      "solution": "SELECT weapon_type, SUM(cost_per_unit * stock_quantity) as total_value FROM Weapons GROUP BY weapon_type;"
    },
    {
      "id": 48,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את שעות הטיסה הממוצעות של הטייסים בכל טייסת מטבלת Pilots.",
      "solution": "SELECT squadron_id, AVG(flight_hours) as avg_flight_hours FROM Pilots GROUP BY squadron_id;"
    },
    {
      "id": 49,
      "current_difficulty": "medium",
      "new_difficulty": "medium",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את כלי הטיס ושמות הטייסות שלהם מטבלאות Aircraft ו-Squadrons.",
      "solution": "SELECT a.tail_number, s.squadron_name FROM Aircraft a JOIN Squadrons s ON a.squadron_id = s.squadron_id;"
    },
    {
      "id": 50,
      "current_difficulty": "medium",
      "new_difficulty": "medium",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את המשימות ושמות הטייסים המבצעים אותן, ממוינות לפי תאריך.",
      "solution": "SELECT m.mission_name, p.pilot_name, m.start_date FROM Missions m JOIN Pilots p ON m.pilot_id = p.pilot_id ORDER BY m.start_date;"
    },
    {
      "id": 51,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 1,
        "has_subquery": true,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את הטייסות שמספר הטייסים הפעילים שלהן מעל הממוצע של כל הטייסות.",
      "solution": "SELECT squadron_name FROM Squadrons WHERE active_pilots > (SELECT AVG(active_pilots) FROM Squadrons);"
    },
    {
      "id": 52,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את הכמות המינימלית והמרבית של מסלולים בבסיסים מטבלת AirBases.",
      "solution": "SELECT MIN(runways_count) as min_runways, MAX(runways_count) as max_runways FROM AirBases;"
    },
    {
      "id": 53,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": true,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית לאיחוד (Union) של טייסים ברמת סיווג 9 וטייסים ברמת סיווג 10.",
      "solution": "σ_security_clearance=9(Pilots) ∪ σ_security_clearance=10(Pilots)"
    },
    {
      "id": 54,
      "current_difficulty": "medium",
      "new_difficulty": "medium",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את הבסיסים ואת שמות המפקדים שלהם, כולל בסיסים ללא מפקד (LEFT JOIN).",
      "solution": "SELECT b.base_name, b.base_commander FROM AirBases b LEFT JOIN Squadrons s ON b.base_id = s.base_id;"
    },
    {
      "id": 55,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את שנת הייצור הממוצעת של כלי הטיס בכל טייסת מטבלת Aircraft.",
      "solution": "SELECT squadron_id, AVG(manufacture_year) as avg_year FROM Aircraft GROUP BY squadron_id;"
    },
    {
      "id": 56,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את הטייסים הצעירים ביותר (גיל מתחת ל-30) עם יותר מ-1000 שעות טיסה.",
      "solution": "SELECT pilot_name, age, flight_hours FROM Pilots WHERE age < 30 AND flight_hours > 1000;"
    },
    {
      "id": 57,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את סך הצריכה של דלק לכל סוג משימה מטבלת Missions.",
      "solution": "SELECT mission_type, SUM(fuel_consumption) as total_fuel FROM Missions GROUP BY mission_type;"
    },
    {
      "id": 58,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית שמחבר את הטבלאות Pilots ו-AirBases על בסיס base_id ומחזיר רק טייסים מבסיסים ...",
      "solution": "σ_location='צפון'(Pilots ⋈_Pilots.base_id=AirBases.base_id AirBases)"
    },
    {
      "id": 59,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": true,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את כמות כלי הנשק בכל בסיס, רק עבור בסיסים שיש בהם יותר מ-50 יחידות נשק.",
      "solution": "SELECT storage_base_id, COUNT(*) as weapon_count FROM Weapons GROUP BY storage_base_id HAVING COUNT(*) > 50;"
    },
    {
      "id": 60,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 1,
        "has_subquery": true,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את כלי הטיס שעלות התפעול שלהם גבוהה מהעלות הממוצעת של כל כלי הטיס.",
      "solution": "SELECT tail_number, cost_per_hour FROM Aircraft WHERE cost_per_hour > (SELECT AVG(cost_per_hour) FROM Aircraft);"
    },
    {
      "id": 61,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית להצגת הפרש (Difference) בין כל הטייסות לבין הטייסות מסוג 'אימון'.",
      "solution": "Squadrons − σ_mission_type='אימון'(Squadrons)"
    },
    {
      "id": 62,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 2,
        "has_subquery": true,
        "has_multiple_subqueries": true,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": true,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 3,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות הטייסות שיש בהן גם טייסים וגם כלי טיס (באמצעות EXISTS).",
      "solution": "SELECT DISTINCT s.squadron_name FROM Squadrons s WHERE EXISTS (SELECT 1 FROM Pilots p WHERE p.squadron_id = s.squadron_id) AND EXISTS (SELECT 1 FROM Aircraft a WHERE a.squadron_id = s.squadron_id);"
    },
    {
      "id": 63,
      "current_difficulty": "medium",
      "new_difficulty": "easy",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את המשימות שבוצעו ב-3 החודשים האחרונים מטבלת Missions.",
      "solution": "SELECT mission_name, start_date FROM Missions WHERE start_date >= DATE_SUB(NOW(), INTERVAL 3 MONTH);"
    },
    {
      "id": 64,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את הטייסים עם הדרגה הגבוהה ביותר (סא\"ל) מטבלת Pilots.",
      "solution": "SELECT pilot_name FROM Pilots WHERE rank = 'סא\"ל';"
    },
    {
      "id": 65,
      "current_difficulty": "medium",
      "new_difficulty": "easy",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את יחס העלות לטווח של כל כלי נשק מטבלת Weapons.",
      "solution": "SELECT weapon_name, (cost_per_unit / range_km) as cost_per_km FROM Weapons WHERE range_km > 0;"
    },
    {
      "id": 66,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את כלי הטיס שנמצאים במצב 'תחזוקה' או 'בדיקות' מטבלת Aircraft.",
      "solution": "SELECT tail_number, status FROM Aircraft WHERE status = 'תחזוקה' OR status = 'בדיקות';"
    },
    {
      "id": 67,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את הבסיסים שנוסדו בעשור הרביעי (1940-1949) מטבלת AirBases.",
      "solution": "SELECT base_name, established_year FROM AirBases WHERE established_year BETWEEN 1940 AND 1949;"
    },
    {
      "id": 68,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית לבחירת כלי נשק מהטבלה Weapons שהמלאי שלהם מעל 100 יחידות.",
      "solution": "σ_stock_quantity>100(Weapons)"
    },
    {
      "id": 69,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את המשימות שצרכו יותר מ-2000 ליטר דלק מטבלת Missions.",
      "solution": "SELECT mission_name, fuel_consumption FROM Missions WHERE fuel_consumption > 2000;"
    },
    {
      "id": 70,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את הטייסים שמשכורתם בין 15,000 ל-25,000 ש\"ח מטבלת Pilots.",
      "solution": "SELECT pilot_name, salary FROM Pilots WHERE salary BETWEEN 15000 AND 25000;"
    },
    {
      "id": 71,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב ביטוי אלגברה יחסית להטלת עמודות aircraft_type ו-max_speed מטבלת Aircraft.",
      "solution": "π_aircraft_type,max_speed(Aircraft)"
    },
    {
      "id": 72,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את כלי הנשק שמיוצרים על ידי 'רפא\"ל' מטבלת Weapons.",
      "solution": "SELECT weapon_name FROM Weapons WHERE supplier = 'רפא\"ל';"
    },
    {
      "id": 73,
      "current_difficulty": "easy",
      "new_difficulty": "easy",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות הטייסות ממוינות בסדר יורד לפי מספר הטייסים הפעילים.",
      "solution": "SELECT squadron_name, active_pilots FROM Squadrons ORDER BY active_pilots DESC;"
    },
    {
      "id": 74,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את הכמות הכוללת של כלי נשק במלאי לכל ספק מטבלת Weapons.",
      "solution": "SELECT supplier, SUM(stock_quantity) as total_weapons FROM Weapons GROUP BY supplier;"
    },
    {
      "id": 75,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את מספר המשימות שבוצעו על ידי כל טייסת מטבלת Missions.",
      "solution": "SELECT squadron_id, COUNT(*) as mission_count FROM Missions GROUP BY squadron_id;"
    },
    {
      "id": 76,
      "current_difficulty": "medium",
      "new_difficulty": "medium",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות הטייסים ושמות הבסיסים שלהם מטבלאות Pilots ו-AirBases.",
      "solution": "SELECT p.pilot_name, b.base_name FROM Pilots p JOIN AirBases b ON p.base_id = b.base_id;"
    },
    {
      "id": 77,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את הטווח הממוצע של כלי הנשק לכל סוג מטבלת Weapons.",
      "solution": "SELECT weapon_type, AVG(range_km) as avg_range FROM Weapons GROUP BY weapon_type;"
    },
    {
      "id": 78,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 2,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 3,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את כלי הטיס ושמות הטייסים שטסו בהם במשימות, כולל כלי טיס שלא טסו.",
      "solution": "SELECT a.tail_number, p.pilot_name FROM Aircraft a LEFT JOIN Missions m ON a.aircraft_id = m.aircraft_id LEFT JOIN Pilots p ON m.pilot_id = p.pilot_id;"
    },
    {
      "id": 79,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": true,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית לאיחוד (Union) של בסיסים במרכז ובסיסים בדרום.",
      "solution": "σ_location='מרכז'(AirBases) ∪ σ_location='דרום'(AirBases)"
    },
    {
      "id": 80,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את שעות הטיסה הכוללות של כל כלי טיס בכל טייסת מטבלת Aircraft.",
      "solution": "SELECT squadron_id, SUM(flight_hours_total) as total_hours FROM Aircraft GROUP BY squadron_id;"
    },
    {
      "id": 81,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את הטייסות שמספר כלי הטיס שלהן גדול ממספר הטייסים הפעילים שלהן.",
      "solution": "SELECT squadron_name FROM Squadrons WHERE aircraft_count > active_pilots;"
    },
    {
      "id": 82,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את משך המשימה הארוך ביותר והקצר ביותר מטבלת Missions.",
      "solution": "SELECT MIN(flight_duration_hours) as shortest, MAX(flight_duration_hours) as longest FROM Missions;"
    },
    {
      "id": 83,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": true,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את הבסיסים שיש בהם יותר מ-2 טייסות (באמצעות HAVING).",
      "solution": "SELECT base_id, COUNT(*) as squadron_count FROM Squadrons GROUP BY base_id HAVING COUNT(*) > 2;"
    },
    {
      "id": 84,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 1,
        "has_subquery": true,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את כלי הנשק שהמלאי שלהם נמוך מהמלאי הממוצע של כל כלי הנשק.",
      "solution": "SELECT weapon_name, stock_quantity FROM Weapons WHERE stock_quantity < (SELECT AVG(stock_quantity) FROM Weapons);"
    },
    {
      "id": 85,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית שמחבר את הטבלאות Weapons ו-AirBases על בסיס storage_base_id ומחזיר רק נשק מב...",
      "solution": "σ_security_level>9(Weapons ⋈_Weapons.storage_base_id=AirBases.base_id AirBases)"
    },
    {
      "id": 86,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 2,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 3,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות הטייסים, הטייסות והמשימות שלהם באמצעות JOIN משולש.",
      "solution": "SELECT p.pilot_name, s.squadron_name, m.mission_name FROM Pilots p JOIN Squadrons s ON p.squadron_id = s.squadron_id JOIN Missions m ON p.pilot_id = m.pilot_id;"
    },
    {
      "id": 87,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית להצגת הפרש (Difference) בין כל הטייסים לבין הטייסים ברמת סיווג מתחת ל-7.",
      "solution": "Pilots − σ_security_clearance<7(Pilots)"
    },
    {
      "id": 88,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 2,
        "has_subquery": true,
        "has_multiple_subqueries": true,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": true,
        "has_union": false,
        "has_intersect": false,
        "has_exists": true,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 3,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות הבסיסים שיש בהם גם טייסות קרב וגם טייסות ביון (באמצעות EXISTS).",
      "solution": "SELECT DISTINCT b.base_name FROM AirBases b WHERE EXISTS (SELECT 1 FROM Squadrons s WHERE s.base_id = b.base_id AND s.mission_type = 'קרב') AND EXISTS (SELECT 1 FROM Squadrons s WHERE s.base_id = b.base_id AND s.mission_type = 'ביון');"
    },
    {
      "id": 89,
      "current_difficulty": "hard",
      "new_difficulty": "medium",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את פירוט העלות השנתית של כל טייס (שם, משכורת שנתית, עלות טיסה שנתית), בהנחה של 1...",
      "solution": "SELECT p.pilot_name, (p.salary * 12) as annual_salary, (a.cost_per_hour * 150) as annual_flight_cost FROM Pilots p JOIN Aircraft a ON p.squadron_id = a.squadron_id;"
    },
    {
      "id": 90,
      "current_difficulty": "hard",
      "new_difficulty": "hard",
      "changed": false,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את הטייסת הכי יעילה - זו עם היחס הגבוה ביותר של משימות מוצלחות לכמות הטייסים.",
      "solution": "SELECT s.squadron_name, (COUNT(m.mission_id) / s.active_pilots) as efficiency FROM Squadrons s JOIN Missions m ON s.squadron_id = m.squadron_id WHERE m.mission_status = 'הושלמה' GROUP BY s.squadron_id ORDER BY efficiency DESC LIMIT 1;"
    }
  ],
  "changes_needed": [
    {
      "id": 3,
      "current_difficulty": "easy",
      "new_difficulty": "medium",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות הטייסים שמשרתים בבסיס 'RMD' ומשכורתם מעל 17000 ש״ח.",
      "solution": "SELECT pilot_name FROM Pilots p JOIN AirBases a ON p.base_id = a.base_id WHERE a.base_code = 'RMD' AND p.salary > 17000;"
    },
    {
      "id": 4,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית לבחירת כלי טיס מהטבלה Aircraft שהם מסוג 'F-16'.",
      "solution": "σ_aircraft_type='F-16'(Aircraft)"
    },
    {
      "id": 6,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": false,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית להטלת עמודות weapon_name ו-cost_per_unit מטבלת Weapons.",
      "solution": "π_weapon_name,cost_per_unit(Weapons)"
    },
    {
      "id": 9,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את המשכורת הממוצעת של טייסים לכל טייסת מטבלת Pilots.",
      "solution": "SELECT squadron_id, AVG(salary) as avg_salary FROM Pilots GROUP BY squadron_id;"
    },
    {
      "id": 10,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמציגה את כמות כלי הטיס בכל טייסת מטבלת Aircraft, ממוינת לפי מספר הטייסת.",
      "solution": "SELECT s.squadron_number, COUNT(*) as aircraft_count FROM Aircraft a JOIN Squadrons s ON a.squadron_id = s.squadron_id GROUP BY s.squadron_number ORDER BY s.squadron_number;"
    },
    {
      "id": 12,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את כלי הטיס המהירים ביותר (מהירות מעל 2000 קמ״ש) שהטווח שלהם פחות מ-3000 ק״מ מטב...",
      "solution": "SELECT aircraft_type, tail_number FROM Aircraft WHERE max_speed > 2000 AND range_km < 3000;"
    },
    {
      "id": 13,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את שמות הבסיסים ואת מספר הטייסים הממוצע בהם, רק עבור בסיסים ברמת ביטחון גבוהה מ-...",
      "solution": "SELECT b.base_name, AVG(s.active_pilots) FROM AirBases b JOIN Squadrons s ON b.base_id = s.base_id WHERE b.security_level > 8 GROUP BY b.base_name;"
    },
    {
      "id": 14,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את העלות הממוצעת לשעת טיסה (אלפי ש״ח/שעה) של כל סוג כלי טיס מטבלת Aircraft.",
      "solution": "SELECT aircraft_type, AVG(cost_per_hour) as avg_cost_per_hour FROM Aircraft GROUP BY aircraft_type;"
    },
    {
      "id": 15,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": true,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית לאיחוד (Union) של טייסים מרמת דוד וטייסים מחצרים.",
      "solution": "σ_base_id=1(Pilots) ∪ σ_base_id=2(Pilots)"
    },
    {
      "id": 17,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את שנת הייסוד הממוצעת של הטייסות בכל סוג משימה מטבלת Squadrons.",
      "solution": "SELECT mission_type, AVG(established_year) as avg_established_year FROM Squadrons GROUP BY mission_type;"
    },
    {
      "id": 18,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמציגה את יחס 'עומס הטייסים' של כל טייסת - מספר הטייסים הפעילים חלקי כמות כלי הטיס מטבלת...",
      "solution": "SELECT squadron_name, (active_pilots / aircraft_count) as pilot_to_aircraft_ratio FROM Squadrons;"
    },
    {
      "id": 25,
      "current_difficulty": "hard",
      "new_difficulty": "medium",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את פירוט עלות התפעול החודשית עבור כל טייס (שם, משכורת, עלות טיסה חודשית), בהנחה ...",
      "solution": "SELECT p.pilot_name, p.salary, (a.cost_per_hour * 20) as monthly_flight_cost FROM Pilots p JOIN Aircraft a ON p.squadron_id = a.squadron_id;"
    },
    {
      "id": 28,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את כלי הנשק שהמלאי שלהם נמוך מהמינימום הנדרש מטבלת Weapons.",
      "solution": "SELECT weapon_name FROM Weapons WHERE stock_quantity < minimum_stock;"
    },
    {
      "id": 29,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית לבחירת טייסים מהטבלה Pilots עם דרגה 'רס\"ן'.",
      "solution": "σ_rank='רס\"ן'(Pilots)"
    },
    {
      "id": 31,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": false,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית להטלת עמודות base_name ו-location מטבלת AirBases.",
      "solution": "π_base_name,location(AirBases)"
    },
    {
      "id": 34,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את הטייסות שמספר כלי הטיס שלהן גדול מ-15 מטבלת Squadrons.",
      "solution": "SELECT squadron_name FROM Squadrons WHERE aircraft_count > 15;"
    },
    {
      "id": 36,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את הבסיסים עם יותר מ-2 מסלולי נחיתה מטבלת AirBases.",
      "solution": "SELECT base_name FROM AirBases WHERE runways_count > 2;"
    },
    {
      "id": 38,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית לבחירת משימות מהטבלה Missions עם רמת עדיפות 5.",
      "solution": "σ_priority_level=5(Missions)"
    },
    {
      "id": 41,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": false,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית להטלת עמודות pilot_name ו-rank מטבלת Pilots.",
      "solution": "π_pilot_name,rank(Pilots)"
    },
    {
      "id": 46,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את כמות הטייסים הכוללת בכל בסיס מטבלת Pilots.",
      "solution": "SELECT base_id, COUNT(*) as total_pilots FROM Pilots GROUP BY base_id;"
    },
    {
      "id": 47,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את העלות הכוללת של כל סוג כלי נשק במלאי מטבלת Weapons.",
      "solution": "SELECT weapon_type, SUM(cost_per_unit * stock_quantity) as total_value FROM Weapons GROUP BY weapon_type;"
    },
    {
      "id": 48,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את שעות הטיסה הממוצעות של הטייסים בכל טייסת מטבלת Pilots.",
      "solution": "SELECT squadron_id, AVG(flight_hours) as avg_flight_hours FROM Pilots GROUP BY squadron_id;"
    },
    {
      "id": 52,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את הכמות המינימלית והמרבית של מסלולים בבסיסים מטבלת AirBases.",
      "solution": "SELECT MIN(runways_count) as min_runways, MAX(runways_count) as max_runways FROM AirBases;"
    },
    {
      "id": 53,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": true,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית לאיחוד (Union) של טייסים ברמת סיווג 9 וטייסים ברמת סיווג 10.",
      "solution": "σ_security_clearance=9(Pilots) ∪ σ_security_clearance=10(Pilots)"
    },
    {
      "id": 55,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את שנת הייצור הממוצעת של כלי הטיס בכל טייסת מטבלת Aircraft.",
      "solution": "SELECT squadron_id, AVG(manufacture_year) as avg_year FROM Aircraft GROUP BY squadron_id;"
    },
    {
      "id": 57,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את סך הצריכה של דלק לכל סוג משימה מטבלת Missions.",
      "solution": "SELECT mission_type, SUM(fuel_consumption) as total_fuel FROM Missions GROUP BY mission_type;"
    },
    {
      "id": 63,
      "current_difficulty": "medium",
      "new_difficulty": "easy",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את המשימות שבוצעו ב-3 החודשים האחרונים מטבלת Missions.",
      "solution": "SELECT mission_name, start_date FROM Missions WHERE start_date >= DATE_SUB(NOW(), INTERVAL 3 MONTH);"
    },
    {
      "id": 65,
      "current_difficulty": "medium",
      "new_difficulty": "easy",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את יחס העלות לטווח של כל כלי נשק מטבלת Weapons.",
      "solution": "SELECT weapon_name, (cost_per_unit / range_km) as cost_per_km FROM Weapons WHERE range_km > 0;"
    },
    {
      "id": 68,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית לבחירת כלי נשק מהטבלה Weapons שהמלאי שלהם מעל 100 יחידות.",
      "solution": "σ_stock_quantity>100(Weapons)"
    },
    {
      "id": 69,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את המשימות שצרכו יותר מ-2000 ליטר דלק מטבלת Missions.",
      "solution": "SELECT mission_name, fuel_consumption FROM Missions WHERE fuel_consumption > 2000;"
    },
    {
      "id": 71,
      "current_difficulty": "easy",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב ביטוי אלגברה יחסית להטלת עמודות aircraft_type ו-max_speed מטבלת Aircraft.",
      "solution": "π_aircraft_type,max_speed(Aircraft)"
    },
    {
      "id": 74,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את הכמות הכוללת של כלי נשק במלאי לכל ספק מטבלת Weapons.",
      "solution": "SELECT supplier, SUM(stock_quantity) as total_weapons FROM Weapons GROUP BY supplier;"
    },
    {
      "id": 75,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את מספר המשימות שבוצעו על ידי כל טייסת מטבלת Missions.",
      "solution": "SELECT squadron_id, COUNT(*) as mission_count FROM Missions GROUP BY squadron_id;"
    },
    {
      "id": 77,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את הטווח הממוצע של כלי הנשק לכל סוג מטבלת Weapons.",
      "solution": "SELECT weapon_type, AVG(range_km) as avg_range FROM Weapons GROUP BY weapon_type;"
    },
    {
      "id": 78,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 2,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 3,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את כלי הטיס ושמות הטייסים שטסו בהם במשימות, כולל כלי טיס שלא טסו.",
      "solution": "SELECT a.tail_number, p.pilot_name FROM Aircraft a LEFT JOIN Missions m ON a.aircraft_id = m.aircraft_id LEFT JOIN Pilots p ON m.pilot_id = p.pilot_id;"
    },
    {
      "id": 79,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": true,
        "join_count": 0,
        "has_join": false,
        "subquery_count": -1,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": true,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 0,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב ביטוי אלגברה יחסית לאיחוד (Union) של בסיסים במרכז ובסיסים בדרום.",
      "solution": "σ_location='מרכז'(AirBases) ∪ σ_location='דרום'(AirBases)"
    },
    {
      "id": 80,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": true,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": false,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את שעות הטיסה הכוללות של כל כלי טיס בכל טייסת מטבלת Aircraft.",
      "solution": "SELECT squadron_id, SUM(flight_hours_total) as total_hours FROM Aircraft GROUP BY squadron_id;"
    },
    {
      "id": 81,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את הטייסות שמספר כלי הטיס שלהן גדול ממספר הטייסים הפעילים שלהן.",
      "solution": "SELECT squadron_name FROM Squadrons WHERE aircraft_count > active_pilots;"
    },
    {
      "id": 82,
      "current_difficulty": "medium",
      "new_difficulty": "hard",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 0,
        "has_join": false,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": true,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 1,
        "has_operator": true,
        "has_function": true
      },
      "question_text": "כתוב שאילתה שמחזירה את משך המשימה הארוך ביותר והקצר ביותר מטבלת Missions.",
      "solution": "SELECT MIN(flight_duration_hours) as shortest, MAX(flight_duration_hours) as longest FROM Missions;"
    },
    {
      "id": 89,
      "current_difficulty": "hard",
      "new_difficulty": "medium",
      "changed": true,
      "analysis": {
        "line_count": 1,
        "has_relational_algebra": false,
        "join_count": 1,
        "has_join": true,
        "subquery_count": 0,
        "has_subquery": false,
        "has_multiple_subqueries": false,
        "has_aggregation": false,
        "has_group_by": false,
        "has_having": false,
        "complex_where": false,
        "has_union": false,
        "has_intersect": false,
        "has_exists": false,
        "has_ddl_dml": false,
        "has_view": false,
        "table_references": 2,
        "has_operator": true,
        "has_function": false
      },
      "question_text": "כתוב שאילתה שמחזירה את פירוט העלות השנתית של כל טייס (שם, משכורת שנתית, עלות טיסה שנתית), בהנחה של 1...",
      "solution": "SELECT p.pilot_name, (p.salary * 12) as annual_salary, (a.cost_per_hour * 150) as annual_flight_cost FROM Pilots p JOIN Aircraft a ON p.squadron_id = a.squadron_id;"
    }
  ],
  "summary": {
    "total_questions": 90,
    "changes_required": 40,
    "new_distribution": {
      "easy": 27,
      "medium": 9,
      "hard": 54
    }
  }
}